wandb: Currently logged in as: longnd (aiotlab). Use `wandb login --relogin` to force relogin
wandb: wandb version 0.13.7 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.13.5
wandb: Run data is saved locally in /home/ace15032jo/Projects/repo2/SampleSelection_easyFL/wandb/run-20230103_172449-1qsxclv4
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run fedalgo5_dev_ratio_1.0_C_0.5_
wandb: â­ï¸ View project at https://wandb.ai/aiotlab/Abnormal_Data_FL
wandb: ðŸš€ View run at https://wandb.ai/aiotlab/Abnormal_Data_FL/runs/1qsxclv4
2023-01-03 17:24:51,059 fflow.py initialize [line:262] INFO Using Logger in `utils.logger.basic_logger`
2023-01-03 17:24:51,059 fflow.py initialize [line:263] INFO Initializing fedtask: pill_classification
2023-01-03 17:24:51,404 fflow.py initialize [line:279] INFO Using model `resnet18` in `benchmark.pill_classification.model.resnet18` as the globally shared model.
2023-01-03 17:24:51,409 fflow.py initialize [line:307] INFO Using sampler `threshold_sampler` in `sampler.threshold_sampler` as the globally shared model.
Using cache found in /home/ace15032jo/.cache/torch/hub/pytorch_vision_v0.10.0
2023-01-03 17:24:58,141 fflow.py initialize [line:327] INFO Initializing Clients: 10 clients of `algorithm.fedalgo5_dev.Client` being created.
2023-01-03 17:24:58,142 fflow.py initialize [line:348] INFO Initializing Server: 1 server of `algorithm.fedalgo5_dev.Server` being created.
2023-01-03 17:24:58,142 fflow.py initialize [line:361] INFO Ready to start.
2023-01-03 17:24:58,142 fedbase.py run [line:62] INFO --------------Round 1--------------
2023-01-03 17:25:02,922 basic_logger.py show_current_output [line:147] INFO test_accuracy                 0.0130
2023-01-03 17:25:02,922 basic_logger.py show_current_output [line:147] INFO test_loss                     4.5173
2023-01-03 17:25:02,922 basic_logger.py time_end [line:77] INFO Eval Time Cost:               4.7801s
2023-01-03 17:25:02,928 fedalgo5_dev.py iterate [line:74] INFO Selected clients : [1, 2, 7, 3, 5]
Using cache found in /home/ace15032jo/.cache/torch/hub/pytorch_vision_v0.10.0
2023-01-03 17:28:47,033 basic_logger.py time_end [line:77] INFO Time Cost:                    228.8906s
2023-01-03 17:28:47,033 fedbase.py run [line:62] INFO --------------Round 2--------------
2023-01-03 17:28:52,353 basic_logger.py show_current_output [line:147] INFO test_accuracy                 0.1662
2023-01-03 17:28:52,353 basic_logger.py show_current_output [line:147] INFO test_loss                     3.9290
2023-01-03 17:28:52,353 basic_logger.py time_end [line:77] INFO Eval Time Cost:               5.3196s
2023-01-03 17:28:52,364 fedalgo5_dev.py iterate [line:74] INFO Selected clients : [3, 0, 2, 7, 9]
Using cache found in /home/ace15032jo/.cache/torch/hub/pytorch_vision_v0.10.0
2023-01-03 17:32:46,487 basic_logger.py time_end [line:77] INFO Time Cost:                    239.4532s
2023-01-03 17:32:46,487 fedbase.py run [line:62] INFO --------------Round 3--------------
2023-01-03 17:32:51,302 basic_logger.py show_current_output [line:147] INFO test_accuracy                 0.2545
2023-01-03 17:32:51,305 basic_logger.py show_current_output [line:147] INFO test_loss                     3.0577
2023-01-03 17:32:51,305 basic_logger.py time_end [line:77] INFO Eval Time Cost:               4.8175s
2023-01-03 17:32:51,318 fedalgo5_dev.py iterate [line:74] INFO Selected clients : [1, 2, 9, 5, 7]
Using cache found in /home/ace15032jo/.cache/torch/hub/pytorch_vision_v0.10.0
2023-01-03 17:35:53,888 basic_logger.py time_end [line:77] INFO Time Cost:                    187.4011s
2023-01-03 17:35:53,889 fedbase.py run [line:62] INFO --------------Round 4--------------
2023-01-03 17:35:58,491 basic_logger.py show_current_output [line:147] INFO test_accuracy                 0.3208
2023-01-03 17:35:58,491 basic_logger.py show_current_output [line:147] INFO test_loss                     2.8270
2023-01-03 17:35:58,491 basic_logger.py time_end [line:77] INFO Eval Time Cost:               4.6024s
2023-01-03 17:35:58,506 fedalgo5_dev.py iterate [line:74] INFO Selected clients : [1, 4, 3, 0, 7]
Using cache found in /home/ace15032jo/.cache/torch/hub/pytorch_vision_v0.10.0
2023-01-03 17:39:51,223 basic_logger.py time_end [line:77] INFO Time Cost:                    237.3338s
2023-01-03 17:39:51,223 fedbase.py run [line:62] INFO --------------Round 5--------------
2023-01-03 17:39:56,260 basic_logger.py show_current_output [line:147] INFO test_accuracy                 0.3273
2023-01-03 17:39:56,265 basic_logger.py show_current_output [line:147] INFO test_loss                     2.5548
2023-01-03 17:39:56,265 basic_logger.py time_end [line:77] INFO Eval Time Cost:               5.0420s
2023-01-03 17:39:56,279 fedalgo5_dev.py iterate [line:74] INFO Selected clients : [7, 1, 4, 6, 3]
Using cache found in /home/ace15032jo/.cache/torch/hub/pytorch_vision_v0.10.0
2023-01-03 17:42:34,636 basic_logger.py time_end [line:77] INFO Time Cost:                    163.4124s
2023-01-03 17:42:34,636 fedbase.py run [line:62] INFO --------------Round 6--------------
2023-01-03 17:42:38,251 basic_logger.py show_current_output [line:147] INFO test_accuracy                 0.3961
2023-01-03 17:42:38,252 basic_logger.py show_current_output [line:147] INFO test_loss                     2.2637
2023-01-03 17:42:38,252 basic_logger.py time_end [line:77] INFO Eval Time Cost:               3.6157s
2023-01-03 17:42:38,256 fedalgo5_dev.py iterate [line:74] INFO Selected clients : [5, 3, 9, 8, 7]
Using cache found in /home/ace15032jo/.cache/torch/hub/pytorch_vision_v0.10.0
2023-01-03 17:45:14,361 basic_logger.py time_end [line:77] INFO Time Cost:                    159.7249s
2023-01-03 17:45:14,361 fedbase.py run [line:62] INFO --------------Round 7--------------
2023-01-03 17:45:23,427 basic_logger.py show_current_output [line:147] INFO test_accuracy                 0.4403
2023-01-03 17:45:23,432 basic_logger.py show_current_output [line:147] INFO test_loss                     2.1131
2023-01-03 17:45:23,432 basic_logger.py time_end [line:77] INFO Eval Time Cost:               9.0702s
2023-01-03 17:45:23,436 fedalgo5_dev.py iterate [line:74] INFO Selected clients : [7, 2, 4, 9, 6]
Using cache found in /home/ace15032jo/.cache/torch/hub/pytorch_vision_v0.10.0
2023-01-03 17:48:03,549 basic_logger.py time_end [line:77] INFO Time Cost:                    169.1873s
2023-01-03 17:48:03,549 fedbase.py run [line:62] INFO --------------Round 8--------------
2023-01-03 17:48:07,452 basic_logger.py show_current_output [line:147] INFO test_accuracy                 0.4390
2023-01-03 17:48:07,453 basic_logger.py show_current_output [line:147] INFO test_loss                     2.1244
2023-01-03 17:48:07,453 basic_logger.py time_end [line:77] INFO Eval Time Cost:               3.9034s
2023-01-03 17:48:07,461 fedalgo5_dev.py iterate [line:74] INFO Selected clients : [3, 5, 1, 4, 8]
Using cache found in /home/ace15032jo/.cache/torch/hub/pytorch_vision_v0.10.0
2023-01-03 17:50:57,421 basic_logger.py time_end [line:77] INFO Time Cost:                    173.8720s
2023-01-03 17:50:57,422 fedbase.py run [line:62] INFO --------------Round 9--------------
2023-01-03 17:51:01,756 basic_logger.py show_current_output [line:147] INFO test_accuracy                 0.5130
2023-01-03 17:51:01,757 basic_logger.py show_current_output [line:147] INFO test_loss                     2.0515
2023-01-03 17:51:01,757 basic_logger.py time_end [line:77] INFO Eval Time Cost:               4.3349s
2023-01-03 17:51:01,765 fedalgo5_dev.py iterate [line:74] INFO Selected clients : [6, 9, 3, 4, 8]
Using cache found in /home/ace15032jo/.cache/torch/hub/pytorch_vision_v0.10.0
2023-01-03 17:53:21,013 basic_logger.py time_end [line:77] INFO Time Cost:                    143.5906s
2023-01-03 17:53:21,013 fedbase.py run [line:62] INFO --------------Round 10--------------
2023-01-03 17:53:24,946 basic_logger.py show_current_output [line:147] INFO test_accuracy                 0.5481
2023-01-03 17:53:24,947 basic_logger.py show_current_output [line:147] INFO test_loss                     1.5668
2023-01-03 17:53:24,947 basic_logger.py time_end [line:77] INFO Eval Time Cost:               3.9339s
2023-01-03 17:53:24,953 fedalgo5_dev.py iterate [line:74] INFO Selected clients : [6, 8, 7, 2, 3]
Using cache found in /home/ace15032jo/.cache/torch/hub/pytorch_vision_v0.10.0
2023-01-03 17:56:32,163 basic_logger.py time_end [line:77] INFO Time Cost:                    191.1504s
2023-01-03 17:56:32,164 fedbase.py run [line:62] INFO --------------Round 11--------------
2023-01-03 17:56:36,157 basic_logger.py show_current_output [line:147] INFO test_accuracy                 0.5312
2023-01-03 17:56:36,157 basic_logger.py show_current_output [line:147] INFO test_loss                     1.6732
2023-01-03 17:56:36,157 basic_logger.py time_end [line:77] INFO Eval Time Cost:               3.9934s
2023-01-03 17:56:36,171 fedalgo5_dev.py iterate [line:74] INFO Selected clients : [6, 5, 8, 3, 1]
Using cache found in /home/ace15032jo/.cache/torch/hub/pytorch_vision_v0.10.0
2023-01-03 17:59:12,513 basic_logger.py time_end [line:77] INFO Time Cost:                    160.3491s
2023-01-03 17:59:12,513 fedbase.py run [line:62] INFO --------------Round 12--------------
2023-01-03 17:59:17,141 basic_logger.py show_current_output [line:147] INFO test_accuracy                 0.6039
2023-01-03 17:59:17,141 basic_logger.py show_current_output [line:147] INFO test_loss                     1.3350
2023-01-03 17:59:17,141 basic_logger.py time_end [line:77] INFO Eval Time Cost:               4.6277s
2023-01-03 17:59:17,150 fedalgo5_dev.py iterate [line:74] INFO Selected clients : [5, 4, 0, 2, 6]
Using cache found in /home/ace15032jo/.cache/torch/hub/pytorch_vision_v0.10.0
2023-01-03 18:03:15,936 basic_logger.py time_end [line:77] INFO Time Cost:                    243.4227s
2023-01-03 18:03:15,937 fedbase.py run [line:62] INFO --------------Round 13--------------
2023-01-03 18:03:19,935 basic_logger.py show_current_output [line:147] INFO test_accuracy                 0.6312
2023-01-03 18:03:19,938 basic_logger.py show_current_output [line:147] INFO test_loss                     1.2667
2023-01-03 18:03:19,938 basic_logger.py time_end [line:77] INFO Eval Time Cost:               4.0009s
2023-01-03 18:03:19,945 fedalgo5_dev.py iterate [line:74] INFO Selected clients : [0, 3, 4, 7, 8]
Using cache found in /home/ace15032jo/.cache/torch/hub/pytorch_vision_v0.10.0
2023-01-03 18:06:24,435 basic_logger.py time_end [line:77] INFO Time Cost:                    188.4982s
2023-01-03 18:06:24,436 fedbase.py run [line:62] INFO --------------Round 14--------------
2023-01-03 18:06:30,409 basic_logger.py show_current_output [line:147] INFO test_accuracy                 0.6299
2023-01-03 18:06:30,409 basic_logger.py show_current_output [line:147] INFO test_loss                     1.2010
2023-01-03 18:06:30,410 basic_logger.py time_end [line:77] INFO Eval Time Cost:               5.9739s
2023-01-03 18:06:30,416 fedalgo5_dev.py iterate [line:74] INFO Selected clients : [0, 5, 7, 2, 4]
Using cache found in /home/ace15032jo/.cache/torch/hub/pytorch_vision_v0.10.0
2023-01-03 18:09:48,302 basic_logger.py time_end [line:77] INFO Time Cost:                    203.8660s
2023-01-03 18:09:48,302 fedbase.py run [line:62] INFO --------------Round 15--------------
2023-01-03 18:09:52,680 basic_logger.py show_current_output [line:147] INFO test_accuracy                 0.6390
2023-01-03 18:09:52,682 basic_logger.py show_current_output [line:147] INFO test_loss                     1.2556
2023-01-03 18:09:52,682 basic_logger.py time_end [line:77] INFO Eval Time Cost:               4.3801s
2023-01-03 18:09:52,687 fedalgo5_dev.py iterate [line:74] INFO Selected clients : [5, 2, 6, 8, 0]
Using cache found in /home/ace15032jo/.cache/torch/hub/pytorch_vision_v0.10.0
2023-01-03 18:12:54,184 basic_logger.py time_end [line:77] INFO Time Cost:                    185.8814s
2023-01-03 18:12:54,184 fedbase.py run [line:62] INFO --------------Round 16--------------
2023-01-03 18:12:57,914 basic_logger.py show_current_output [line:147] INFO test_accuracy                 0.5662
2023-01-03 18:12:57,914 basic_logger.py show_current_output [line:147] INFO test_loss                     1.5588
2023-01-03 18:12:57,915 basic_logger.py time_end [line:77] INFO Eval Time Cost:               3.7304s
2023-01-03 18:12:57,922 fedalgo5_dev.py iterate [line:74] INFO Selected clients : [5, 6, 7, 9, 4]
Using cache found in /home/ace15032jo/.cache/torch/hub/pytorch_vision_v0.10.0
2023-01-03 18:16:05,960 basic_logger.py time_end [line:77] INFO Time Cost:                    191.7759s
2023-01-03 18:16:05,960 fedbase.py run [line:62] INFO --------------Round 17--------------
2023-01-03 18:16:10,882 basic_logger.py show_current_output [line:147] INFO test_accuracy                 0.6455
2023-01-03 18:16:10,882 basic_logger.py show_current_output [line:147] INFO test_loss                     1.3714
2023-01-03 18:16:10,883 basic_logger.py time_end [line:77] INFO Eval Time Cost:               4.9219s
2023-01-03 18:16:10,891 fedalgo5_dev.py iterate [line:74] INFO Selected clients : [4, 3, 2, 7, 5]
Using cache found in /home/ace15032jo/.cache/torch/hub/pytorch_vision_v0.10.0
2023-01-03 18:19:08,873 basic_logger.py time_end [line:77] INFO Time Cost:                    182.9120s
2023-01-03 18:19:08,873 fedbase.py run [line:62] INFO --------------Round 18--------------
2023-01-03 18:19:12,982 basic_logger.py show_current_output [line:147] INFO test_accuracy                 0.6896
2023-01-03 18:19:12,982 basic_logger.py show_current_output [line:147] INFO test_loss                     1.1195
2023-01-03 18:19:12,982 basic_logger.py time_end [line:77] INFO Eval Time Cost:               4.1092s
2023-01-03 18:19:12,995 fedalgo5_dev.py iterate [line:74] INFO Selected clients : [6, 2, 1, 4, 7]
Using cache found in /home/ace15032jo/.cache/torch/hub/pytorch_vision_v0.10.0
2023-01-03 18:22:27,191 basic_logger.py time_end [line:77] INFO Time Cost:                    198.3173s
2023-01-03 18:22:27,191 fedbase.py run [line:62] INFO --------------Round 19--------------
2023-01-03 18:22:32,735 basic_logger.py show_current_output [line:147] INFO test_accuracy                 0.6740
2023-01-03 18:22:32,736 basic_logger.py show_current_output [line:147] INFO test_loss                     1.0483
2023-01-03 18:22:32,736 basic_logger.py time_end [line:77] INFO Eval Time Cost:               5.5447s
2023-01-03 18:22:32,743 fedalgo5_dev.py iterate [line:74] INFO Selected clients : [1, 0, 2, 3, 8]
Using cache found in /home/ace15032jo/.cache/torch/hub/pytorch_vision_v0.10.0
2023-01-03 18:26:09,836 basic_logger.py time_end [line:77] INFO Time Cost:                    222.6450s
2023-01-03 18:26:09,836 fedbase.py run [line:62] INFO --------------Round 20--------------
2023-01-03 18:26:14,875 basic_logger.py show_current_output [line:147] INFO test_accuracy                 0.7364
2023-01-03 18:26:14,875 basic_logger.py show_current_output [line:147] INFO test_loss                     0.9615
2023-01-03 18:26:14,875 basic_logger.py time_end [line:77] INFO Eval Time Cost:               5.0388s
2023-01-03 18:26:14,882 fedalgo5_dev.py iterate [line:74] INFO Selected clients : [4, 5, 1, 9, 7]
Using cache found in /home/ace15032jo/.cache/torch/hub/pytorch_vision_v0.10.0
2023-01-03 18:29:32,470 basic_logger.py time_end [line:77] INFO Time Cost:                    202.6329s
2023-01-03 18:29:32,470 fedbase.py run [line:62] INFO --------------Round 21--------------
2023-01-03 18:29:39,316 basic_logger.py show_current_output [line:147] INFO test_accuracy                 0.7169
2023-01-03 18:29:39,318 basic_logger.py show_current_output [line:147] INFO test_loss                     1.0063
2023-01-03 18:29:39,318 basic_logger.py time_end [line:77] INFO Eval Time Cost:               6.8481s
2023-01-03 18:29:39,326 fedalgo5_dev.py iterate [line:74] INFO Selected clients : [3, 4, 8, 0, 9]
Using cache found in /home/ace15032jo/.cache/torch/hub/pytorch_vision_v0.10.0
2023-01-03 18:32:26,187 basic_logger.py time_end [line:77] INFO Time Cost:                    173.7170s
2023-01-03 18:32:26,187 fedbase.py run [line:62] INFO --------------Round 22--------------
2023-01-03 18:32:33,817 basic_logger.py show_current_output [line:147] INFO test_accuracy                 0.7416
2023-01-03 18:32:33,821 basic_logger.py show_current_output [line:147] INFO test_loss                     0.9215
2023-01-03 18:32:33,822 basic_logger.py time_end [line:77] INFO Eval Time Cost:               7.6339s
2023-01-03 18:32:33,829 fedalgo5_dev.py iterate [line:74] INFO Selected clients : [4, 6, 5, 1, 7]
Using cache found in /home/ace15032jo/.cache/torch/hub/pytorch_vision_v0.10.0
2023-01-03 18:35:37,229 basic_logger.py time_end [line:77] INFO Time Cost:                    191.0409s
2023-01-03 18:35:37,229 fedbase.py run [line:62] INFO --------------Round 23--------------
2023-01-03 18:35:42,166 basic_logger.py show_current_output [line:147] INFO test_accuracy                 0.7299
2023-01-03 18:35:42,169 basic_logger.py show_current_output [line:147] INFO test_loss                     0.9321
2023-01-03 18:35:42,169 basic_logger.py time_end [line:77] INFO Eval Time Cost:               4.9402s
2023-01-03 18:35:42,178 fedalgo5_dev.py iterate [line:74] INFO Selected clients : [7, 9, 4, 3, 2]
Using cache found in /home/ace15032jo/.cache/torch/hub/pytorch_vision_v0.10.0
2023-01-03 18:39:06,983 basic_logger.py time_end [line:77] INFO Time Cost:                    209.7535s
2023-01-03 18:39:06,983 fedbase.py run [line:62] INFO --------------Round 24--------------
2023-01-03 18:39:11,418 basic_logger.py show_current_output [line:147] INFO test_accuracy                 0.7403
2023-01-03 18:39:11,418 basic_logger.py show_current_output [line:147] INFO test_loss                     0.8393
2023-01-03 18:39:11,418 basic_logger.py time_end [line:77] INFO Eval Time Cost:               4.4351s
2023-01-03 18:39:11,426 fedalgo5_dev.py iterate [line:74] INFO Selected clients : [7, 9, 0, 4, 6]
Using cache found in /home/ace15032jo/.cache/torch/hub/pytorch_vision_v0.10.0
2023-01-03 18:42:35,675 basic_logger.py time_end [line:77] INFO Time Cost:                    208.6922s
2023-01-03 18:42:35,676 fedbase.py run [line:62] INFO --------------Round 25--------------
2023-01-03 18:42:41,316 basic_logger.py show_current_output [line:147] INFO test_accuracy                 0.7273
2023-01-03 18:42:41,317 basic_logger.py show_current_output [line:147] INFO test_loss                     0.9947
2023-01-03 18:42:41,317 basic_logger.py time_end [line:77] INFO Eval Time Cost:               5.6410s
2023-01-03 18:42:41,324 fedalgo5_dev.py iterate [line:74] INFO Selected clients : [3, 6, 0, 9, 4]
Using cache found in /home/ace15032jo/.cache/torch/hub/pytorch_vision_v0.10.0
2023-01-03 18:45:47,199 basic_logger.py time_end [line:77] INFO Time Cost:                    191.5234s
2023-01-03 18:45:47,200 fedbase.py run [line:62] INFO --------------Round 26--------------
2023-01-03 18:45:52,847 basic_logger.py show_current_output [line:147] INFO test_accuracy                 0.7649
2023-01-03 18:45:52,847 basic_logger.py show_current_output [line:147] INFO test_loss                     0.8239
2023-01-03 18:45:52,847 basic_logger.py time_end [line:77] INFO Eval Time Cost:               5.6473s
2023-01-03 18:45:52,860 fedalgo5_dev.py iterate [line:74] INFO Selected clients : [0, 4, 3, 9, 2]
Using cache found in /home/ace15032jo/.cache/torch/hub/pytorch_vision_v0.10.0
2023-01-03 18:49:50,435 basic_logger.py time_end [line:77] INFO Time Cost:                    243.2352s
2023-01-03 18:49:50,435 fedbase.py run [line:62] INFO --------------Round 27--------------
2023-01-03 18:49:57,228 basic_logger.py show_current_output [line:147] INFO test_accuracy                 0.7468
2023-01-03 18:49:57,228 basic_logger.py show_current_output [line:147] INFO test_loss                     0.9055
2023-01-03 18:49:57,228 basic_logger.py time_end [line:77] INFO Eval Time Cost:               6.7927s
2023-01-03 18:49:57,242 fedalgo5_dev.py iterate [line:74] INFO Selected clients : [7, 4, 8, 2, 0]
Using cache found in /home/ace15032jo/.cache/torch/hub/pytorch_vision_v0.10.0
2023-01-03 18:53:13,345 basic_logger.py time_end [line:77] INFO Time Cost:                    202.9093s
2023-01-03 18:53:13,345 fedbase.py run [line:62] INFO --------------Round 28--------------
2023-01-03 18:53:17,184 basic_logger.py show_current_output [line:147] INFO test_accuracy                 0.7584
2023-01-03 18:53:17,184 basic_logger.py show_current_output [line:147] INFO test_loss                     0.8298
2023-01-03 18:53:17,184 basic_logger.py time_end [line:77] INFO Eval Time Cost:               3.8389s
2023-01-03 18:53:17,187 fedalgo5_dev.py iterate [line:74] INFO Selected clients : [3, 7, 1, 4, 2]
Using cache found in /home/ace15032jo/.cache/torch/hub/pytorch_vision_v0.10.0
2023-01-03 18:56:45,940 basic_logger.py time_end [line:77] INFO Time Cost:                    212.5949s
2023-01-03 18:56:45,941 fedbase.py run [line:62] INFO --------------Round 29--------------
2023-01-03 18:56:51,650 basic_logger.py show_current_output [line:147] INFO test_accuracy                 0.7273
2023-01-03 18:56:51,654 basic_logger.py show_current_output [line:147] INFO test_loss                     0.9515
2023-01-03 18:56:51,655 basic_logger.py time_end [line:77] INFO Eval Time Cost:               5.7138s
2023-01-03 18:56:51,661 fedalgo5_dev.py iterate [line:74] INFO Selected clients : [9, 3, 4, 2, 1]
Using cache found in /home/ace15032jo/.cache/torch/hub/pytorch_vision_v0.10.0
2023-01-03 18:59:48,704 basic_logger.py time_end [line:77] INFO Time Cost:                    182.7636s
2023-01-03 18:59:48,705 fedbase.py run [line:62] INFO --------------Round 30--------------
2023-01-03 18:59:52,544 basic_logger.py show_current_output [line:147] INFO test_accuracy                 0.7519
2023-01-03 18:59:52,545 basic_logger.py show_current_output [line:147] INFO test_loss                     0.8828
2023-01-03 18:59:52,545 basic_logger.py time_end [line:77] INFO Eval Time Cost:               3.8397s
2023-01-03 18:59:52,552 fedalgo5_dev.py iterate [line:74] INFO Selected clients : [1, 0, 9, 3, 6]
Using cache found in /home/ace15032jo/.cache/torch/hub/pytorch_vision_v0.10.0
2023-01-03 19:03:05,253 basic_logger.py time_end [line:77] INFO Time Cost:                    196.5478s
2023-01-03 19:03:05,253 fedbase.py run [line:62] INFO --------------Round 31--------------
2023-01-03 19:03:09,510 basic_logger.py show_current_output [line:147] INFO test_accuracy                 0.7247
2023-01-03 19:03:09,510 basic_logger.py show_current_output [line:147] INFO test_loss                     0.9531
2023-01-03 19:03:09,510 basic_logger.py time_end [line:77] INFO Eval Time Cost:               4.2571s
2023-01-03 19:03:09,523 fedalgo5_dev.py iterate [line:74] INFO Selected clients : [6, 3, 2, 9, 4]
Using cache found in /home/ace15032jo/.cache/torch/hub/pytorch_vision_v0.10.0
2023-01-03 19:06:27,033 basic_logger.py time_end [line:77] INFO Time Cost:                    201.7800s
2023-01-03 19:06:27,034 fedbase.py run [line:62] INFO --------------Round 32--------------
2023-01-03 19:06:31,318 basic_logger.py show_current_output [line:147] INFO test_accuracy                 0.7610
2023-01-03 19:06:31,320 basic_logger.py show_current_output [line:147] INFO test_loss                     0.8182
2023-01-03 19:06:31,320 basic_logger.py time_end [line:77] INFO Eval Time Cost:               4.2866s
2023-01-03 19:06:31,333 fedalgo5_dev.py iterate [line:74] INFO Selected clients : [9, 0, 2, 7, 5]
Using cache found in /home/ace15032jo/.cache/torch/hub/pytorch_vision_v0.10.0
2023-01-03 19:09:50,270 basic_logger.py time_end [line:77] INFO Time Cost:                    203.2364s
2023-01-03 19:09:50,271 fedbase.py run [line:62] INFO --------------Round 33--------------
2023-01-03 19:09:54,353 basic_logger.py show_current_output [line:147] INFO test_accuracy                 0.7571
2023-01-03 19:09:54,355 basic_logger.py show_current_output [line:147] INFO test_loss                     0.8479
2023-01-03 19:09:54,355 basic_logger.py time_end [line:77] INFO Eval Time Cost:               4.0844s
2023-01-03 19:09:54,371 fedalgo5_dev.py iterate [line:74] INFO Selected clients : [9, 8, 0, 2, 5]
Using cache found in /home/ace15032jo/.cache/torch/hub/pytorch_vision_v0.10.0
2023-01-03 19:13:46,616 basic_logger.py time_end [line:77] INFO Time Cost:                    236.3447s
2023-01-03 19:13:46,616 fedbase.py run [line:62] INFO --------------Round 34--------------
2023-01-03 19:13:50,686 basic_logger.py show_current_output [line:147] INFO test_accuracy                 0.7571
2023-01-03 19:13:50,687 basic_logger.py show_current_output [line:147] INFO test_loss                     0.8992
2023-01-03 19:13:50,687 basic_logger.py time_end [line:77] INFO Eval Time Cost:               4.0707s
2023-01-03 19:13:50,700 fedalgo5_dev.py iterate [line:74] INFO Selected clients : [6, 8, 0, 3, 7]
Using cache found in /home/ace15032jo/.cache/torch/hub/pytorch_vision_v0.10.0
2023-01-03 19:17:01,526 basic_logger.py time_end [line:77] INFO Time Cost:                    194.9101s
2023-01-03 19:17:01,527 fedbase.py run [line:62] INFO --------------Round 35--------------
2023-01-03 19:17:05,543 basic_logger.py show_current_output [line:147] INFO test_accuracy                 0.7468
2023-01-03 19:17:05,543 basic_logger.py show_current_output [line:147] INFO test_loss                     0.9112
2023-01-03 19:17:05,543 basic_logger.py time_end [line:77] INFO Eval Time Cost:               4.0163s
2023-01-03 19:17:05,553 fedalgo5_dev.py iterate [line:74] INFO Selected clients : [4, 8, 6, 2, 3]
Using cache found in /home/ace15032jo/.cache/torch/hub/pytorch_vision_v0.10.0
2023-01-03 19:20:09,977 basic_logger.py time_end [line:77] INFO Time Cost:                    188.4497s
2023-01-03 19:20:09,977 fedbase.py run [line:62] INFO --------------Round 36--------------
2023-01-03 19:20:15,386 basic_logger.py show_current_output [line:147] INFO test_accuracy                 0.7623
2023-01-03 19:20:15,386 basic_logger.py show_current_output [line:147] INFO test_loss                     0.8560
2023-01-03 19:20:15,386 basic_logger.py time_end [line:77] INFO Eval Time Cost:               5.4090s
2023-01-03 19:20:15,392 fedalgo5_dev.py iterate [line:74] INFO Selected clients : [1, 4, 7, 0, 9]
Using cache found in /home/ace15032jo/.cache/torch/hub/pytorch_vision_v0.10.0
2023-01-03 19:24:08,344 basic_logger.py time_end [line:77] INFO Time Cost:                    238.3668s
2023-01-03 19:24:08,345 fedbase.py run [line:62] INFO --------------Round 37--------------
2023-01-03 19:24:13,172 basic_logger.py show_current_output [line:147] INFO test_accuracy                 0.7805
2023-01-03 19:24:13,175 basic_logger.py show_current_output [line:147] INFO test_loss                     0.7799
2023-01-03 19:24:13,175 basic_logger.py time_end [line:77] INFO Eval Time Cost:               4.8308s
2023-01-03 19:24:13,186 fedalgo5_dev.py iterate [line:74] INFO Selected clients : [3, 1, 6, 4, 2]
Using cache found in /home/ace15032jo/.cache/torch/hub/pytorch_vision_v0.10.0
2023-01-03 19:27:53,258 basic_logger.py time_end [line:77] INFO Time Cost:                    224.9135s
2023-01-03 19:27:53,259 fedbase.py run [line:62] INFO --------------Round 38--------------
2023-01-03 19:27:59,601 basic_logger.py show_current_output [line:147] INFO test_accuracy                 0.7545
2023-01-03 19:27:59,604 basic_logger.py show_current_output [line:147] INFO test_loss                     0.8376
2023-01-03 19:27:59,604 basic_logger.py time_end [line:77] INFO Eval Time Cost:               6.3450s
2023-01-03 19:27:59,613 fedalgo5_dev.py iterate [line:74] INFO Selected clients : [8, 3, 6, 7, 4]
2023-01-03 19:27:59,617 main.py main [line:27] ERROR Exception Logged
Traceback (most recent call last):
  File "/home/ace15032jo/Projects/repo2/SampleSelection_easyFL/main.py", line 24, in main
    server.run()
  File "/home/ace15032jo/Projects/repo2/SampleSelection_easyFL/algorithm/fedbase.py", line 75, in run
    self.iterate()
  File "/home/ace15032jo/Projects/repo2/SampleSelection_easyFL/algorithm/fedalgo5_dev.py", line 80, in iterate
    threshold = self.cal_threshold(self.aggreagted_histogram)
  File "/home/ace15032jo/Projects/repo2/SampleSelection_easyFL/algorithm/fedalgo5_dev.py", line 210, in cal_threshold
    threshold_value = utils.fmodule.Sampler.cal_threshold(
  File "/home/ace15032jo/Projects/repo2/SampleSelection_easyFL/sampler/threshold_sampler.py", line 61, in cal_threshold
    thresh_value = thresh_list[::-1][i]
IndexError: index 3561 is out of bounds for axis 0 with size 3561
Update ratio round 1: 1.0 >>>>  1.0
Number of clients have cached is: 0
Total samples which participate training : 3080/3080 samples
Update ratio round 2: 1.0 >>>>  1.0
Number of clients have cached is: 0
Total samples which participate training : 3120/3120 samples
Update ratio round 3: 1.0 >>>>  0.88
Number of clients have cached is: 3
Total samples which participate training : 2457/2860 samples
Update ratio round 4: 1.0 >>>>  0.84
Number of clients have cached is: 4
Total samples which participate training : 2905/3420 samples
Update ratio round 5: 1.0 >>>>  0.84
Number of clients have cached is: 4
Total samples which participate training : 2079/2840 samples
Update ratio round 6: 1.0 >>>>  0.84
Number of clients have cached is: 4
Total samples which participate training : 1982/2280 samples
Update ratio round 7: 1.0 >>>>  0.8
Number of clients have cached is: 5
Total samples which participate training : 1904/2620 samples
Update ratio round 8: 1.0 >>>>  0.8
Number of clients have cached is: 5
Total samples which participate training : 2251/2960 samples
Update ratio round 9: 1.0 >>>>  0.8
Number of clients have cached is: 5
Total samples which participate training : 1600/2420 samples
Update ratio round 10: 1.0 >>>>  0.8
Number of clients have cached is: 5
Total samples which participate training : 1959/2500 samples
Update ratio round 11: 1.0 >>>>  0.8
Number of clients have cached is: 5
Total samples which participate training : 1952/2700 samples
Update ratio round 12: 1.0 >>>>  0.8027526081228923
Number of clients have cached is: 5
Total samples which participate training : 2330/3440 samples
Update ratio round 13: 1.0 >>>>  0.8080534470482945
Number of clients have cached is: 5
Total samples which participate training : 2296/3000 samples
Update ratio round 14: 1.0 >>>>  0.8074455585962833
Number of clients have cached is: 5
Total samples which participate training : 2606/3400 samples
Update ratio round 15: 1.0 >>>>  0.8147541382573565
Number of clients have cached is: 5
Total samples which participate training : 2239/3100 samples
Update ratio round 16: 1.0 >>>>  0.8219479450931924
Number of clients have cached is: 5
Total samples which participate training : 2198/2440 samples
Update ratio round 17: 1.0 >>>>  0.838705263730434
Number of clients have cached is: 5
Total samples which participate training : 2141/3000 samples
Update ratio round 18: 1.0 >>>>  0.8371715946910503
Number of clients have cached is: 5
Total samples which participate training : 2273/3000 samples
Update ratio round 19: 1.0 >>>>  0.8545564105128445
Number of clients have cached is: 5
Total samples which participate training : 2814/3460 samples
Update ratio round 20: 1.0 >>>>  0.8228868621160446
Number of clients have cached is: 5
Total samples which participate training : 2457/2780 samples
Update ratio round 21: 1.0 >>>>  0.8559731532955781
Number of clients have cached is: 5
Total samples which participate training : 2060/3000 samples
Update ratio round 22: 1.0 >>>>  0.8
Number of clients have cached is: 5
Total samples which participate training : 2382/2820 samples
Update ratio round 23: 1.0 >>>>  0.8
Number of clients have cached is: 5
Total samples which participate training : 2398/2800 samples
Update ratio round 24: 1.0 >>>>  0.8160456405278296
Number of clients have cached is: 5
Total samples which participate training : 2449/2860 samples
Update ratio round 25: 1.0 >>>>  0.8
Number of clients have cached is: 5
Total samples which participate training : 2515/3080 samples
Update ratio round 26: 1.0 >>>>  0.8
Number of clients have cached is: 5
Total samples which participate training : 2856/3420 samples
Update ratio round 27: 1.0 >>>>  0.8
Number of clients have cached is: 5
Total samples which participate training : 2700/3160 samples
Update ratio round 28: 1.0 >>>>  0.8
Number of clients have cached is: 5
Total samples which participate training : 2508/3180 samples
Update ratio round 29: 1.0 >>>>  0.8
Number of clients have cached is: 5
Total samples which participate training : 2766/3180 samples
Update ratio round 30: 1.0 >>>>  0.8
Number of clients have cached is: 5
Total samples which participate training : 2853/3160 samples
Update ratio round 31: 1.0 >>>>  0.8
Number of clients have cached is: 5
Total samples which participate training : 2840/2840 samples
Update ratio round 32: 1.0 >>>>  0.8
Number of clients have cached is: 5
Total samples which participate training : 2563/3100 samples
Update ratio round 33: 1.0 >>>>  0.8
Number of clients have cached is: 5
Total samples which participate training : 3060/3060 samples
Update ratio round 34: 1.0 >>>>  0.8
Number of clients have cached is: 5
Total samples which participate training : 2740/2740 samples
Update ratio round 35: 1.0 >>>>  0.8
Number of clients have cached is: 5
Total samples which participate training : 2396/2800 samples
Update ratio round 36: 1.0 >>>>  0.8
Number of clients have cached is: 5
Total samples which participate training : 3200/3200 samples
Update ratio round 37: 1.0 >>>>  0.8050885162294805
Number of clients have cached is: 5
Total samples which participate training : 3220/3220 samples
Update ratio round 38: 1.0 >>>>  0.8
Number of clients have cached is: 5
Traceback (most recent call last):
  File "/home/ace15032jo/Projects/repo2/SampleSelection_easyFL/main.py", line 24, in main
    server.run()
  File "/home/ace15032jo/Projects/repo2/SampleSelection_easyFL/algorithm/fedbase.py", line 75, in run
    self.iterate()
  File "/home/ace15032jo/Projects/repo2/SampleSelection_easyFL/algorithm/fedalgo5_dev.py", line 80, in iterate
    threshold = self.cal_threshold(self.aggreagted_histogram)
  File "/home/ace15032jo/Projects/repo2/SampleSelection_easyFL/algorithm/fedalgo5_dev.py", line 210, in cal_threshold
    threshold_value = utils.fmodule.Sampler.cal_threshold(
  File "/home/ace15032jo/Projects/repo2/SampleSelection_easyFL/sampler/threshold_sampler.py", line 61, in cal_threshold
    thresh_value = thresh_list[::-1][i]
IndexError: index 3561 is out of bounds for axis 0 with size 3561

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ace15032jo/Projects/repo2/SampleSelection_easyFL/main.py", line 33, in <module>
    main()
  File "/home/ace15032jo/Projects/repo2/SampleSelection_easyFL/main.py", line 28, in main
    raise RuntimeError
RuntimeError
wandb: Waiting for W&B process to finish... (failed 1). Press Control-C to abort syncing.
